"use strict";angular.module("cartModule",[]),angular.module("authModule",[]);var moheera=angular.module("moheera",["ui.bootstrap","ui.router","angularChart","ngResource","authModule","homeModule","userModule","productModule","orderModule","cartModule","reportModule"]);moheera.config(["$urlRouterProvider","$stateProvider",function(e,o){e.otherwise("notfound"),o.state("notfound",{url:"/notfound",templateUrl:"public/modules/config/view/notfound.config.view.html",controller:"errorConfigController"}).state("home",{url:"",templateUrl:"public/modules/home/view/index.home.view.html",controller:"indexHomeController"}).state("contact",{url:"/contact",templateUrl:"public/modules/home/view/contact.home.view.html",controller:"indexHomeController"}).state("about",{url:"/about",templateUrl:"public/modules/home/view/about.home.view.html",controller:"indexHomeController"}).state("signin",{url:"/signin",templateUrl:"public/modules/auth/view/signin.auth.view.html",controller:"signinAuthController"}).state("signup",{url:"/signup",templateUrl:"public/modules/auth/view/signup.auth.view.html",controller:"signupAuthController"}).state("signout",{url:"signout",controller:"signoutAuthController"}).state("profile",{url:"/profile",templateUrl:"public/modules/user/view/profile.user.view.html",controller:"profileUserControlller"}).state("profile.remove",{url:"/remove",templateUrl:"public/modules/user/view/remove.account.user.view.html",controller:"removeAccountUserController"}).state("profile.setting",{url:"/setting",templateUrl:"public/modules/user/view/setting.user.view.html",controller:"settingUserController"}).state("profile.userPassword",{url:"/account/password",templateUrl:"public/modules/user/view/change.password.user.view.html",controller:"changePasswordUserController"}).state("profile.report",{url:"/report",templateUrl:"public/modules/report/view/all.report.view.html",controller:"allReportController"}).state("profile.singleOrder",{url:"/order/:id",templateUrl:"public/modules/order/view/single.order.view.html",controller:"singleOrderController"}).state("profile.order",{url:"/order",templateUrl:"public/modules/order/view/all.order.view.html",controller:"allOrderController"}).state("profile.addProduct",{url:"/product/add",templateUrl:"public/modules/product/view/add.product.view.html",controller:"addProductController"}).state("profile.editProduct",{url:"/product/:name/edit",templateUrl:"public/modules/product/view/edit.product.view.html",controller:"editProductController"}).state("profile.singleProduct",{url:"/product/:name",templateUrl:"public/modules/product/view/single.product.view.html",controller:"singleProductController"}).state("profile.cart",{url:"/cart",templateUrl:"public/modules/cart/view/all.cart.view.html",controller:"allCartController"}).state("user",{url:"/:id",templateUrl:"public/modules/user/view/profile.user.view.html",controller:"profileUserControlller"}).state("user.singleProduct",{url:"/:userId/productId",templateUrl:"public/modules/user/view/profile.user.view.html",controller:"profileUserControlller"})}]).run(["$rootScope",function(e){e.logged=!1}]),angular.module("homeModule",[]),angular.module("orderModule",[]),angular.module("productModule",[]),angular.module("reportModule",[]),angular.module("userModule",[]),angular.module("cartModule").controller("allCartController",["$scope","$location",function(){}]),angular.module("authModule").controller("signinAuthController",["registerUserConfigFactory","$scope","$http","$location",function(e,o,r,t){o.signIn=function(){r.post("/login",o.credentials).success(function(o){e.setUser(o),t.path("/profile")}).error(function(e){o.error=e})}}]),angular.module("authModule").controller("signoutAuthController",["registerUserConfigFactory","$http","$location",function(e,o,r){o.get("/logout").success(function(){e.clearUserInfo(),r.path("/home")})}]),angular.module("authModule").controller("signupAuthController",["registerUserConfigFactory","$scope","$location","connectAuthFactory",function(e,o,r,t){e.getUser()&&r.path("/profile"),o.signUp=function(){t.save(o.credentials,function(){r.path("/signin")},function(e){o.error=e.data.message})}}]),angular.module("authModule").factory("connectAuthFactory",["$resource",function(e){return e("/user/:id")}]),angular.module("moheera").controller("errorConfigController",["$scope",function(){}]),angular.module("moheera").controller("navMenu",["$rootScope","$scope",function(e,o){o.navbarCollapsed=!1,o.$on("$stateChangeSuccess",function(){o.navbarCollapsed=!1}),e.$watch("logged",function(){e.logged?(o.loggedLink=!0,o.notLoggedLink=!1):(o.loggedLink=!1,o.notLoggedLink=!0)})}]),angular.module("moheera").factory("registerUserConfigFactory",["$window","$rootScope","$q",function(e,o,r){var t={};return t.user=!1,t.readUserInfo=function(){return t.user=e.userInfo||!1},t.clearUserInfo=function(){o.logged=!1,t.user=e.userInfo=!1},t.setUser=function(r){t.user=e.userInfo=r||!1,t.user&&(o.logged=!0)},t.getUser=function(){var e=r.defer();return e.resolve(t.readUserInfo()),e.promise.then(function(e){e&&(t.user=e,o.logged=!0)}),t.user},t}]),angular.module("homeModule").controller("indexHomeController",["registerUserConfigFactory","$location","$scope",function(e,o,r){r.user=e.getUser(),r.user&&o.path("/profile")}]),angular.module("orderModule").controller("allOrderController",["$scope","$location",function(e){e.status="test status"}]),angular.module("orderModule").controller("singleOrderController",["$scope","$location",function(){}]),angular.module("productModule").controller("addProductController",["$scope","$location","connectProductFactory","productCategoryFactory",function(e,o,r,t){e.categoryOptions=t,e.addProduct=function(){r.save(e.newProduct,function(){o.path("profile")},function(o){console.log(o),e.error=o.data.message})}}]),angular.module("productModule").controller("editProductController",["$scope","$stateParams","$location","connectProductFactory","productCategoryFactory",function(e,o,r,t,n){e.categoryOptions=n,t.get({getByName:o.name},function(o){e.productInfo=o},function(){r.path("/notfound")}),e.updateProductInfo=function(){t.update(e.productInfo,function(){e.error=!1,e.success=!0},function(o){e.success=!1,e.error=o.data.message})}}]),angular.module("productModule").controller("singleProductController",["$scope","$stateParams","connectProductFactory","$location","connectCommentFactory","registerUserConfigFactory",function(e,o,r,t,n,l){e.user=l.getUser(),e.productName=o.name,r.get({getByName:e.productName},function(o){e.product=o},function(){t.path("/notfound")}),e.showRemoveProductBox=function(){e.removeProductBox=!0},e.removeProduct=function(){r.remove({id:e.product._id},function(){t.path("/profile")},function(o){e.error=o.data.message})},e.cancelRemoveProduct=function(){e.removeProductBox=!1},e.addComment=function(){e.newComment&&n.save({id:e.product._id},{content:e.newComment},function(o){e.product.comment.push(o),e.newComment=""},function(o){e.error=o.data.message})},e.removeComment=function(o,r,t){n.remove({commentId:r,id:t},function(){e.product.comment.splice(o,1)},function(o){e.error=o.data.message})}}]),angular.module("userModule").factory("connectCommentFactory",["$resource",function(e){return e("product/:id/comment/:commentId",{id:"@id",commentId:"@commentId"})}]),angular.module("productModule").factory("connectProductFactory",["$resource",function(e){return e("/product/:id/:getByName",{id:"@_id",getByName:"@getByName"},{update:{method:"PUT"}})}]),angular.module("productModule").factory("productCategoryFactory",[function(){return["men","women","kid"]}]),angular.module("reportModule").controller("allReportController",["$scope","$location",function(e){e.productView={dataset:[{day:"2013-01-02_00:00:00",sales:13461.295202,income:12365.053},{day:"2014-01-02_00:00:00",sales:1346.202,income:1235.3},{day:"2015-01-02_00:00:00",sales:161.295202,income:1365.053}],schema:{day:{type:"datetime",format:"%Y-%m-%d_%H:%M:%S",name:"Date"}},options:{rows:[{key:"income",type:"bar"},{key:"sales"}],xAxis:{key:"day",displayFormat:"%Y-%m-%d %H:%M:%S"}}},e.productSaleByCategory={dataset:[{day:"2013-01-02_00:00:00",sales:13461.295202,income:12365.053},{day:"2014-01-02_00:00:00",sales:1346.202,income:1235.3},{day:"2015-01-02_00:00:00",sales:161.295202,income:1365.053}],schema:{day:{type:"datetime",format:"%Y-%m-%d_%H:%M:%S",name:"Date"}},options:{rows:[{key:"income",type:"pie"},{key:"sales"}],xAxis:{key:"day",displayFormat:"%Y-%m-%d %H:%M:%S"}}}}]),angular.module("userModule").controller("changePasswordUserController",["$scope","$location","connectUserFactory",function(e,o,r){e.changeUserPassword=function(){e.success=!1,e.error=!1,r.update({action:"password"},{newPassword:e.userInfo.newPassword,currentPassword:e.userInfo.currentPassword},function(){e.success=!0,e.userInfo.newPassword="",e.userInfo.currentPassword="",e.userInfo.verifyPassword=""},function(o){e.error=o.data.message})},e.noMatch=function(){return e.userInfo.newPassword==e.userInfo.verifyPassword?!1:!0}}]),angular.module("userModule").controller("profileUserControlller",["registerUserConfigFactory","connectProductFactory","$location","$scope",function(e,o,r,t){t.userInfo=e.getUser(),t.userInfo||r.path("/signin"),o.query(function(e){t.userProducts=e})}]),angular.module("userModule").controller("removeAccountUserController",["$scope","$location","connectUserFactory",function(e,o,r){e.cancelRemove=function(){o.path("/profile")},e.confirmRemove=function(){r.remove(function(){o.path("/")},function(o){e.error=o.data.message})}}]),angular.module("userModule").controller("settingUserController",["$scope","$location","connectUserFactory",function(e,o,r){e.removeAccount=function(){o.path("/profile/remove")},e.updateAccount=function(){r.update(e.userInfo,function(){e.success=!0},function(o){e.error=o.data.message})}}]),angular.module("userModule").factory("connectUserFactory",["$resource",function(e){return e("/user/:action/:byUserName",{name:"@byUserName",action:"@action"},{update:{method:"PUT"}})}]);